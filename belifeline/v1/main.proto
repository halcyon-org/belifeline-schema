syntax = "proto3";

package belifeline.v1;

import "belifeline/v1/api.proto";

option go_package = "github.com/halcyon-org/kizuna/gen/belifeline/v1;mainv1";

/**
 * Services related to kizuna itself
 * No authentication is required and public access is always available
 */
service ServerService {
  /**
   * Health check
   * Returns the status message of the server
   */
  rpc Health(HealthRequest) returns (HealthResponse) {}
}

/**
 * Services related to system administration, such as account creation
 * Administrator (Admin API Key) authentication is required
 */
service AdminService {
  // Create or update a client. The client ID is automatically generated and returned
  rpc ClientSet(ClientSetRequest) returns (ClientSetResponse) {}
  // List all clients
  rpc ClientList(ClientListRequest) returns (ClientListResponse) {}
  // Delete a client
  rpc ClientDelete(ClientDeleteRequest) returns (ClientDeleteResponse) {}
  // Revoke and renew the client's API key. The client's API key is automatically generated and returned
  rpc ClientRevoke(ClientRevokeRequest) returns (ClientRevokeResponse) {}

  // Create or update an external information. The external information provider ID is automatically generated and returned
  rpc ExtInfoSet(ExtInfoSetRequest) returns (ExtInfoSetResponse) {}
  // Delete an external information
  rpc ExtInfoDelete(ExtInfoDeleteRequest) returns (ExtInfoDeleteResponse) {}

  /**
   * Create or update a koyo
   * The koyo ID is automatically generated and returned
   */
  rpc KoyoCreate(KoyoCreateRequest) returns (KoyoCreateResponse) {}
  // Delete a koyo
  rpc KoyoDelete(KoyoDeleteRequest) returns (KoyoDeleteResponse) {}
  // Revoke and renew the koyo's API key. The koyo's API key is automatically generated and returned
  rpc KoyoApiRevoke(KoyoApiRevokeRequest) returns (KoyoApiRevokeResponse) {}
}

/**
 * Service as an information provider provided by belifeline
 * Client (Client Information API Key), Admin (Admin API Key), Koyo (Koyo Information API Key), or ExtInfo (External Information API Key) authentication required
 */
service ProviderService {
  // List all external information
  rpc ExtInfoList(ExtInfoListRequest) returns (stream ExtInfoListResponse) {}
  // List all koyo information
  rpc KoyoList(KoyoListRequest) returns (stream KoyoListResponse) {}
  // Get basic information about External Information
  rpc ExtInfoGet(ExtInfoGetRequest) returns (ExtInfoGetResponse) {}
  // Get koyo data generated by Koyo
  rpc KoyoDataGet(KoyoDataGetRequest) returns (KoyoDataGetResponse) {}
}

/**
 * Service that provides something for updating external information
 * Authentication of either Admin (Admin API Key) or ExtInfo (External Information API Key) is required.
 */
service ExtInfoService {
  // rpc to inform kizuna that extinfo (external api and other information) has been updated
  rpc ExtInfoUpdateNotification(ExtInfoUpdateNotificationRequest) returns (ExtInfoUpdateNotificationResponse) {}
}

/**
 * Koyo itself is a service for interacting with Kizuna
 * Authentication of either Admin (Admin API Key) or Koyo (Koyo Information API Key) is required.
 */
service KoyoService {
  // Update koyo information
  rpc KoyoUpdate(KoyoUpdateRequest) returns (KoyoUpdateResponse) {}
  // After koyo processes the data, it calls this rpc to store the generated data (in permanent storage via kizuna)
  rpc KoyoDataAdd(KoyoDataAddRequest) returns (KoyoDataAddResponse) {}
}
